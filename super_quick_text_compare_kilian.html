<!DOCTYPE html>
<html>
<head>
  <link rel="stylesheet" href="diff2html.min.css">
  <link rel="stylesheet" href="kilian_extra_css.css">
  <script src="diff2html-ui.min.js"></script>
  <script src="diff.min.js"></script>
  <script src="prism.min.js"></script>
  <link rel="stylesheet" href="prism-synthwave84.css">
  <script src="hogan.min.js"></script>

</head>
<body>
  <h2>CODE DIFF</h2>
  <div class="textarea-container">
    <textarea id="text1" spellcheck="false">Code1_JUST_PaStE_it_iN
Old_Code2
Old_Code3
Old_Code4
Old_Code5
</textarea>
    <textarea id="text2" autocomplete="off" spellcheck="false">Code1_JUST_PaStE_it_iN
New_CodeXYZ1
New_CodeXYZ2
New_CodeXYZ3
Old_Code3
Old_Code4
Old_Code5
</textarea>
  </div>

  <div id="diff-container"></div>

  <script>
    text1Element = document.getElementById('text1');
    text2Element = document.getElementById('text2');
    diffContainerElement = document.getElementById('diff-container');

    function updateDiff() {
      text1 = text1Element.value;
      text2 = text2Element.value;

      diffInput = `--- a/a.js
+++ b/b.js
@@ -1,5 +1,3 @@
-${text1.replace(/\n/g, '\n-')}
+${text2.replace(/\n/g, '\n+')}`;

      configuration = { 
        drawFileList: false, 
        matching: 'lines', 
        outputFormat: 'side-by-side', 
        highlight: true 
      };
      diff2htmlUi = new Diff2HtmlUI(diffContainerElement, diffInput, configuration);
      diff2htmlUi.draw();
      diff2htmlUi.highlightCode();
    }

    text1Element.addEventListener('input', updateDiff);
    text2Element.addEventListener('input', updateDiff);

    updateDiff();
  </script>

  <div id="comparison">

    <div id="line-diff-container">
      <h3>Line Level Diff</h3>
      <div id="line-diff"></div>
    </div>
    <div id="word-diff-container">
      <h3>Word Level Diff</h3>
      <div id="word-diff"></div>
    </div>
    <div id="char-diff-container">
      <h3>Char Level Diff</h3>
      <div id="char-diff"></div>
    </div>
  </div>

  <script>
function compareText() {
  text1 = document.getElementById('text1').value.trim();
 text2 = document.getElementById('text2').value.trim();

  charDiff = Diff.diffChars(text1, text2);
  wordDiff = Diff.diffWords(text1, text2);
  lineDiff = Diff.diffLines(text1, text2);

  function createDiffFragment(diff, id) {
  var fragment = document.createDocumentFragment();
  for (var i = 0; i < diff.length; i++) {
    var node = document.createElement('span');

    node.appendChild(document.createTextNode(diff[i].value));
    if (diff[i].added) {
      node.style.color = 'green';
    } else if (diff[i].removed) {
      node.style.color = 'red';
    }
    node.style.whiteSpace = 'pre'; // add this line
    fragment.appendChild(node);
    if (diff[i].value.endsWith("\n")) {
      var br = document.createElement('br');
      fragment.appendChild(br);
      fragment.appendChild(document.createTextNode("\n"));
    }
  }
  document.getElementById(id).textContent = '';
  document.getElementById(id).appendChild(fragment);
}
  createDiffFragment(charDiff, 'char-diff');
  createDiffFragment(wordDiff, 'word-diff');
  createDiffFragment(lineDiff, 'line-diff');
}

text1Element.addEventListener('input', compareText);
text2Element.addEventListener('input', compareText);

compareText(); // call the function once to display the initial differences
</script>
</body>
</html>