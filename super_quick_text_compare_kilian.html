<!DOCTYPE html>
<html>
<head>
  <link rel="stylesheet" href="dep/diff2html.min.css">
  <script src="dep/diff2html-ui.min.js"></script>
  <script src="dep/diff.min.js"></script>
  <script src="dep/prism.min.js"></script>
  <link rel="stylesheet" href="dep/kilian_extra_css.css">
  <link rel="stylesheet" href="dep/prism-synthwave84.css">
  <script src="dep/hogan.min.js"></script>

</head>
<body>
  <img src="dep/code_diff_unicorn.webp" style="width: 5%; position: absolute; left: 20px; top: 10px;" />
  <h2>CODE DIFF</h2>
  <div class="textarea-container">
    <textarea id="text1" spellcheck="false">Code1_JUST_PaStE_it_iN
Old_Code2
Old_Code3
Old_Code4
Old_Code5
</textarea>
    <textarea id="text2" autocomplete="off" spellcheck="false">Code1_JUST_PaStE_it_iN
New_CodeXYZ1
New_CodeXYZ2
New_CodeXYZ3
Old_Code3
Old_Code4
Old_Code5
</textarea>
  </div>

  <div id="diff-container"></div>

  <script>
    text1Element = document.getElementById('text1');
    text2Element = document.getElementById('text2');
    diffContainerElement = document.getElementById('diff-container');

    function updateDiff() {
      text1 = text1Element.value;
      text2 = text2Element.value;

      diffInput = `--- a/a.js
+++ b/b.js
@@ -1,5 +1,3 @@
-${text1.replace(/\n/g, '\n-')}
+${text2.replace(/\n/g, '\n+')}`;

      configuration = { 
        drawFileList: false, 
        matching: 'lines', 
        outputFormat: 'side-by-side', 
        highlight: true 
      };
      diff2htmlUi = new Diff2HtmlUI(diffContainerElement, diffInput, configuration);
      diff2htmlUi.draw();
      diff2htmlUi.highlightCode();
    }

    text1Element.addEventListener('input', updateDiff);
    text2Element.addEventListener('input', updateDiff);

    updateDiff();
  </script>

  <div id="comparison">

    <div id="line-diff-container">
      <h3>Line Level Diff</h3>
      <div id="line-diff"></div>
    </div>
    <div id="word-diff-container">
      <h3>Word Level Diff</h3>
      <div id="word-diff"></div>
    </div>
    <div id="char-diff-container">
      <h3>Char Level Diff</h3>
      <div id="char-diff"></div>
    </div>
  </div>

  <script>
function compareText() {
  text1 = document.getElementById('text1').value.trim();
 text2 = document.getElementById('text2').value.trim();

  charDiff = Diff.diffChars(text1, text2);
  wordDiff = Diff.diffWords(text1, text2);
  lineDiff = Diff.diffLines(text1, text2);

  function createDiffFragment(diff, id) {
  var fragment = document.createDocumentFragment();
  for (var i = 0; i < diff.length; i++) {
    var node = document.createElement('span');

    node.appendChild(document.createTextNode(diff[i].value));
    if (diff[i].added) {
      node.style.color = 'green';
    } else if (diff[i].removed) {
      node.style.color = 'red';
    }
    node.style.whiteSpace = 'pre'; // add this line
    fragment.appendChild(node);
    if (diff[i].value.endsWith("\n")) {
      var br = document.createElement('br');
      fragment.appendChild(br);
      fragment.appendChild(document.createTextNode("\n"));
    }
  }
  document.getElementById(id).textContent = '';
  document.getElementById(id).appendChild(fragment);
}
  createDiffFragment(charDiff, 'char-diff');
  createDiffFragment(wordDiff, 'word-diff');
  createDiffFragment(lineDiff, 'line-diff');
}

text1Element.addEventListener('input', compareText);
text2Element.addEventListener('input', compareText);

compareText(); // call the function once to display the initial differences
</script>


<link rel="stylesheet" href="dep/animate.min.css">
<script>
  const animations = ['animate__bounceIn', 'animate__fadeIn', 'animate__slideInUp', 'animate__zoomIn'];
  const observer = new MutationObserver(mutations => {
    mutations.forEach(mutation => {
      if (mutation.addedNodes && mutation.addedNodes.length > 0) {
        Array.prototype.forEach.call(mutation.addedNodes, node => {
          if (node.nodeType === 1) { // Only consider element nodes
            const randomAnimation = animations[Math.floor(Math.random() * animations.length)];
            node.classList.add(randomAnimation);
          }
        });
      }
    });
  });

  observer.observe(document.body, {
    childList: true,
    subtree: true
  });




inputField = document.getElementById('text1');

inputField.addEventListener('input', () => {
  document.body.classList.add('shake');
  setTimeout(() => {
    document.body.classList.remove('shake');
  }, 1000);
});


</script>
<style>
  .pixel {
  position: absolute;
  width: 2px;
  height: 2px;
  background-color: #fff;
  transform: scale(0);
  transition: transform 0.5s;
}

.pixel.active {
  transform: scale(1);
}

.shake {
  animation: shake 0.5s;
}

@keyframes shake {
  0% {
    transform: translate(0, 0);
  }
  20% {
    transform: translate(-5px,30px);
  }
  40% {
    transform: translate(5px, 0);
  }
  60% {
    transform: translate(-5px, 0);
  }
  80% {
    transform: translate(5px, 23px);
  }
  100% {
    transform: translate(0, 0);
  }
}

.shake {
  animation: shake 0.5s;
}

@keyframes shake {
  0% {
    transform: translate(0, 32px);
  }
  20% {
    transform: translate(-5px, 0);
  }
  40% {
    transform: translate(5px, 0);
  }
  60% {
    transform: translate(-5px, 0);
  }
  80% {
    transform: translate(5px, 0);
  }
  100% {
    transform: translate(0, 0);
  }
}
</style>
</body>
</html>